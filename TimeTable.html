<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TimeTable</title>
    <style>
      input,
      textarea {
        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
        text-align: center;
        overflow: hidden;
        line-height: 2.2;
        vertical-align: top;
      }

      .container {
        height: 95vh;
        border: none;
      }
      .top {
        width: 100%;
        height: 4vh;
        display: flex;
        border: none;
        position: fixed;
      }
      .middle {
        width: 100%;
        height: 95%;
        padding-top: 4vh;
      }
      .bottom {
        width: 100%;
        height: 4vh;
        display: flex;
        position: fixed;
      }
      .middleDay {
        width: 100%;
        height: 100%;
        display: flex;
      }
      .middleTeacher {
        width: 100%;
        height: 100%;
        display: flex;
      }

      .dayTable {
        height: 100%;
        outline: 1px solid black;
        display: flex;
      }
      .teacherTable {
        height: 100%;
        outline: 1px solid black;
        display: flex;
      }
      .dayTable .timeColumn {
        height: 100%;
        min-width: 10vh;
        display: flex;
        flex-direction: column;

        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
        text-align: center;
        line-height: 200%;
      }
      .dayTable .teacherColumn {
        height: 100%;
        width: 14vh;
        display: flex;
        flex-direction: column;

        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
        text-align: center;
        line-height: 200%;
      }
      .teacherTable .timeColumn {
        height: 100%;
        width: 10vh;
        display: flex;
        flex-direction: column;

        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
        text-align: center;
        line-height: 200%;
      }
      .teacherTable .teacherColumn {
        height: 100%;
        width: 14vh;
        display: flex;
        flex-direction: column;

        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS", sans-serif;
        text-align: center;
        line-height: 200%;
      }

      .cell {
        height: 3.7%;
        outline: 1px solid black;
      }
      .textCell {
        height: 100%;
        width: 100%;
        resize: none;
        padding: 0;
        border: 0;
      }

      .noCursor {
        caret-color: transparent;
      }
      .yesCursor {
        caret-color: auto;
      }
      .teacherName {
        height: 100%;
        width: 100%;
        border: 0;
        padding: 0;
        font-size: 100%;
        background-color: rgb(223, 227, 230);
      }

      .btnSave {
        width: 4%;
        height: 100%;
      }
      .btnDayandTeacher {
        width: 10%;
        height: 100%;
      }
      .btnAddTeacher,
      .btnDeleteTeacher,
      .btnDeletePage,
      .btnMerge,
      .btnVertical {
        width: 10%;
        height: 100%;
      }

      .btnAddPage,
      .btnDeletePage {
        width: 2.5%;
        height: 100%;
      }
      .btnAddedPage {
        width: 12%;
        height: 100%;
      }
      .btnClicked {
        background-color: rgb(180, 176, 176);
      }

      .cellClicked {
        background-color: rgb(221, 228, 222);
      }

      .namingInput {
        background-color: inherit;
        border: 0;
        width: 90%;
        height: 90%;
      }

      .namingInput:focus {
        border: none;
        outline: none;
      }

      .redBorder {
        border: 2px dotted red;
      }
      .ctrlBorder {
        box-shadow: 0 0 0 1px green inset, 0 0 0 1px green;
      }
      .hide {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="top">
        <button class="btnSave" onclick="saveData()">저장</button>
        <button class="btnDayandTeacher" onclick="goToTeacherPage()">요일별</button>
        <button class="btnAddTeacher" onclick="addTeacher()">선생님 추가</button>
        <button class="btnDeleteTeacher" onclick="deleteTeacher()">선생님 삭제</button>
        <button class="btnMerge" onclick="mergeCell()">병합/해제</button>
        <button class="btnVertical" onclick="verticalText()">텍스트 정렬</button>
      </div>
      <div class="middle">
        <div class="middleDay">
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">월</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onkeydown="preventKeyDown(event)"><input class="teacherName" onfocus="nameTeacher(this)" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">화</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">수</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">목</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">금</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">토</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
          <div class="dayTable">
            <div class="timeColumn">
              <div class="cell firstCell">일</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell" onfocus="nameTeacher(this)" onkeydown="preventKeyDown(event)"><input class="teacherName" /></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
        </div>
        <div class="middleTeacher hide">
          <div class="teacherTable">
            <div class="timeColumn">
              <div class="cell firstCell" onkeydown="preventKeyDown(event)"><input class="teacherName" onfocus="nameTeacher(this)" /></div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
              <div class="cell">12:00-12:30</div>
              <div class="cell">12:30-1:00</div>
              <div class="cell">1:00-1:30</div>
              <div class="cell">1:30-2:00</div>
              <div class="cell">2:00-2:30</div>
              <div class="cell">2:30-3:00</div>
              <div class="cell">3:00-3:30</div>
              <div class="cell">3:30-4:00</div>
              <div class="cell">4:00-4:30</div>
              <div class="cell">4:30-5:00</div>
              <div class="cell">5:00-5:30</div>
              <div class="cell">5:30-6:00</div>
              <div class="cell">6:00-6:30</div>
              <div class="cell">6:30-7:00</div>
              <div class="cell">7:00-7:30</div>
              <div class="cell">7:30-8:00</div>
              <div class="cell">8:00-8:30</div>
              <div class="cell">8:30-9:00</div>
              <div class="cell">9:00-9:30</div>
              <div class="cell">9:30-10:00</div>
              <div class="cell">10:00-10:30</div>
              <div class="cell">10:30-11:00</div>
              <div class="cell">11:00-11:30</div>
              <div class="cell">11:30-12:00</div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">월</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">화</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">수</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">목</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">금</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">토</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
            <div class="teacherColumn" onkeydown="moveCell(this)" onclick="mouseClick(this)">
              <div class="cell firstCell">일</div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
              <div class="cell"><textarea class="textCell noCursor"></textarea></div>
            </div>
          </div>
        </div>
      </div>
      <div class="bottom">
        <button class="btnAddPage" onclick="addPageBtn()">+</button>
        <button class="btnAddedPage btnClicked" onclick="shiftPage()" ondblclick="pageBtnNaming(this)"></button>
        <button class="btnDeletePage" onclick="deletePage()">X</button>
      </div>
    </div>
    <script>
      ////////변수 선언////////
      let pageIndex;
      let thisPage;
      let thisPageBtn;
      let numOfPages;
      let numOfTeachers;
      let dataCell = {
        pageNum: undefined,
        tableNum: undefined,
      };

      let currentCell;
      let currentRow;
      let currentTable;
      let cellRow;
      let cellCol;
      let shadowRow = 0;
      let shadowCol = 0;
      let shadowCell;

      let ctrlStorage = [];
      let cellStorage = {};
      let turnX;

      let writing = false;

      //key control
      document.addEventListener("keydown", function (event) {
        if (document.activeElement.classList.contains("textCell")) {
          if (event.ctrlKey) {
            if (event.key == "s") {
              event.preventDefault();
              saveData();
            } else if (event.key == "c") {
              event.preventDefault();
              ctrlC();
            } else if (event.key == "x") {
              event.preventDefault();
              ctrlX();
            } else if (event.key == "v") {
              event.preventDefault();
              ctrlV();
            } else if (event.key == "z") {
              event.preventDefault();
              ctrlZ();
            }
          } else if (event.shiftKey) {
            if (event.key == "Enter") {
              event.preventDefault();
              mergeCell();
            }
          } else if (event.key == "F2") {
            event.preventDefault();
            if (document.activeElement.classList.contains("noCursor")) {
              document.activeElement.classList.add("yesCursor");
              let lastLength = document.activeElement.value.length;
              document.activeElement.setSelectionRange(lastLength, lastLength);
              writing = true;
            }
          }
        }
      });

      //click control
      document.addEventListener("click", function () {
        findThisPage();
        writing = false;
        if (document.querySelectorAll(".namingInput").length > 0) {
          for (let i = 0; i < document.querySelectorAll(".namingInput").length; i++) {
            let button = thisPageBtn;
            button.innerHTML = document.querySelectorAll(".namingInput")[i].value;
          }
        }
      });

      ////////함수 선언////////
      //기본 페이지 정보 선언 및 변경 함수
      function findThisPage() {
        for (let i = 0; i < document.querySelectorAll(".btnAddedPage").length; i++) {
          if (document.querySelectorAll(".btnAddedPage")[i].classList.contains("btnClicked")) {
            thisPageBtn = document.querySelectorAll(".btnAddedPage")[i];
            pageIndex = Array.prototype.indexOf.call(thisPageBtn.parentNode.children, thisPageBtn) - 1;
          }
          thisPage = document.querySelectorAll(".middle")[pageIndex];
        }
        numOfPages = document.querySelectorAll(".middle").length;
        numOfTeachers = thisPage.querySelector(".dayTable").querySelectorAll(".teacherColumn").length;
      }

      //셀 이동함수
      function moveCell(div) {
        currentCell = document.activeElement;
        currentRow = document.activeElement.parentNode.parentNode;
        currentTable = currentRow.parentNode;
        cellRow = Array.prototype.indexOf.call(div.children, currentCell.parentNode) - 1;
        cellCol = Array.prototype.indexOf.call(div.parentNode.children, div) - 1;

        let upCell = cellRow > 0 ? currentRow.querySelectorAll(".textCell")[cellRow - 1] : null;
        let downCell = cellRow < 25 ? currentRow.querySelectorAll(".textCell")[cellRow + 1] : null;
        let leftCell = cellCol > 0 ? currentTable.querySelectorAll(".teacherColumn")[cellCol - 1].querySelectorAll(".textCell")[cellRow] : null;
        let rightCell = cellCol < currentTable.children.length - 2 ? currentTable.querySelectorAll(".teacherColumn")[cellCol + 1].querySelectorAll(".textCell")[cellRow] : null;

        //F2입력시, Alt+Enter는 줄바꿈, Enter or Tab은 다음셀로 이동
        if (writing) {
          if (event.altKey && event.key == "Enter") {
            event.preventDefault();
            currentCell.value += "\n";
            currentCell.classList.add("yesCursor");
          } else if (event.key == "Enter" || event.key == "Tab") {
            event.preventDefault();
            if (cellRow < 25) {
              cellRow++;
              while (currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                cellRow++;
                if (cellRow > 25) {
                  cellRow--;
                  break;
                }
              }
            }
            currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].focus();
            writing = false;
          }
          return;
        }

        if (event.ctrlKey && event.shiftKey) {
          if (event.key == "ArrowUp") {
            if (shadowCol == 0) {
              while (cellRow + shadowRow > 0) {
                if (shadowRow <= 0) {
                  shadowRow--;
                  if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide")) {
                  } else {
                    currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    currentCell.classList.add("cellClicked");
                  }
                } else {
                  shadowRow--;
                  currentRow.querySelectorAll(".textCell")[cellRow + shadowRow + 1].classList.remove("cellClicked");
                }
                if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            } else {
              while (cellRow + shadowRow > 0) {
                if (shadowRow <= 0) {
                  shadowRow--;
                  for (let i = 0; i >= shadowRow; i--) {
                    if (shadowCol > 0) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    } else {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  }
                } else {
                  shadowRow--;
                  for (let i = 0; i <= shadowRow; i++) {
                    if (shadowCol > 0) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i + 1].classList.remove("cellClicked");
                      }
                    } else {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i + 1].classList.remove("cellClicked");
                      }
                    }
                  }
                }
                if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            }
          } else if (event.key == "ArrowDown") {
            if (shadowCol == 0) {
              while (cellRow + shadowRow < 25) {
                if (shadowRow >= 0) {
                  shadowRow++;
                  if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide")) {
                  } else {
                    currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    currentCell.classList.add("cellClicked");
                  }
                } else {
                  shadowRow++;
                  currentRow.querySelectorAll(".textCell")[cellRow + shadowRow - 1].classList.remove("cellClicked");
                }
                if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            } else {
              while (cellRow + shadowRow < 25) {
                if (shadowRow >= 0) {
                  shadowRow++;
                  for (let i = 0; i <= shadowRow; i++) {
                    if (shadowCol > 0) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    } else {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  }
                } else {
                  shadowRow++;
                  for (let i = 0; i >= shadowRow; i--) {
                    if (shadowCol > 0) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i - 1].classList.remove("cellClicked");
                      }
                    } else {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i - 1].classList.remove("cellClicked");
                      }
                    }
                  }
                }
                if (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            }
          } else if (event.key == "ArrowLeft") {
            if (shadowRow == 0) {
              while (cellCol + shadowCol > 0) {
                if (shadowCol <= 0) {
                  shadowCol--;
                  if (
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide") ||
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("merged")
                  ) {
                    shadowCol++;
                    break;
                  }
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                } else {
                  shadowCol--;
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol + 1].querySelectorAll(".textCell")[cellRow + shadowRow].classList.remove("cellClicked");
                }

                if (currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            } else {
              while (cellCol + shadowCol > 0) {
                if (shadowCol <= 0) {
                  shadowCol--;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  } else {
                    for (let i = 0; i >= shadowRow; i--) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  }
                } else {
                  shadowCol--;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                    }
                  } else {
                    for (let i = 0; i >= shadowRow; i--) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                    }
                  }
                }
                if (currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].value != "") {
                  break;
                }
              }
            }
          } else if (event.key == "ArrowRight") {
            if (shadowRow == 0) {
              while (cellCol + shadowCol < currentTable.querySelectorAll(".teacherColumn").length - 1) {
                if (shadowCol >= 0) {
                  shadowCol++;
                  if (
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide") ||
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("merged")
                  ) {
                    shadowCol--;
                    break;
                  }
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                } else {
                  shadowCol++;
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol - 1].querySelectorAll(".textCell")[cellRow + shadowRow].classList.remove("cellClicked");
                }

                if (currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + shadowRow].value != "") {
                  break;
                }
              }
            } else {
              while (cellCol + shadowCol < currentTable.querySelectorAll(".teacherColumn").length - 1) {
                if (shadowCol >= 0) {
                  shadowCol++;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  } else {
                    for (let i = 0; i >= shadowRow; i--) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol + j].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                      }
                    }
                  }
                } else {
                  shadowCol++;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                    }
                  } else {
                    for (let i = 0; i >= shadowRow; i--) {
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                      for (let j = 0; j <= Math.abs(shadowCol); j++) {
                        currentTable.querySelectorAll(".teacherColumn")[cellCol - j - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                      }
                    }
                  }
                }
                if (currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].value != "") {
                  break;
                }
              }
            }
          }
          ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        } else if (event.ctrlKey) {
          if (event.key == "ArrowUp") {
            if (currentCell.value == "") {
              if (upCell && upCell.value == "") {
                while (cellRow > 0 && upCell.value == "") {
                  cellRow--;
                  upCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
              } else {
                if (cellRow > 0) {
                  cellRow--;
                }
              }
            } else {
              if (upCell && upCell.value == "") {
                while (cellRow > 0 && upCell.value == "") {
                  cellRow--;
                  upCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
              } else {
                while (cellRow > 0 && upCell.value != "") {
                  cellRow--;
                  upCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
                if (cellRow != 0) {
                  cellRow++;
                }
              }
            }

            //클릭된셀 색 제거
            document.querySelectorAll(".cellClicked").forEach(function (element) {
              element.classList.remove("cellClicked");
            });
            shadowRow = 0;
            shadowCol = 0;
          } else if (event.key == "ArrowDown") {
            if (currentCell.value == "") {
              if (downCell && downCell.value == "") {
                while (cellRow < 25 && downCell.value == "") {
                  cellRow++;
                  downCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
                if (cellRow == 25) {
                  if (currentRow.querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                    while (!currentRow.querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("merged")) {
                      cellRow--;
                    }
                  }
                }
              } else {
                if (cellRow < 25) {
                  cellRow++;
                }
              }
            } else {
              if (downCell && downCell.value == "") {
                while (cellRow < 25 && downCell.value == "") {
                  cellRow++;
                  downCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
                if (cellRow == 25) {
                  if (currentRow.querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                    while (!currentRow.querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("merged")) {
                      cellRow--;
                    }
                  }
                }
              } else {
                while (cellRow < 25 && downCell.value != "") {
                  cellRow++;
                  downCell = currentRow.querySelectorAll(".textCell")[cellRow];
                }
                if (cellRow != 25) {
                  cellRow--;
                }
              }
            }

            //클릭된셀 색 제거
            document.querySelectorAll(".cellClicked").forEach(function (element) {
              element.classList.remove("cellClicked");
            });
            shadowRow = 0;
            shadowCol = 0;
          } else if (event.key == "ArrowLeft") {
            if (currentCell.value == "") {
              if (leftCell && leftCell.value == "") {
                while (cellCol > 0 && leftCell.value == "") {
                  cellCol--;
                  leftCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
              } else {
                if (cellCol > 0) {
                  cellCol--;
                }
              }
            } else {
              if (leftCell && leftCell.value == "") {
                while (cellCol > 0 && leftCell.value == "") {
                  cellCol--;
                  leftCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
              } else {
                while (cellCol > 0 && leftCell.value != "") {
                  cellCol--;
                  leftCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
                if (cellCol != 0) {
                  cellCol++;
                }
              }
            }

            //클릭된셀 색 제거
            document.querySelectorAll(".cellClicked").forEach(function (element) {
              element.classList.remove("cellClicked");
            });
            shadowRow = 0;
            shadowCol = 0;
          } else if (event.key == "ArrowRight") {
            if (currentCell.value == "") {
              if (rightCell && rightCell.value == "") {
                while (cellCol < currentTable.children.length - 2 && rightCell.value == "") {
                  cellCol++;
                  rightCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
              } else {
                if (cellCol < currentTable.children.length - 2) {
                  cellCol++;
                }
              }
            } else {
              if (rightCell && rightCell.value == "") {
                while (cellCol < currentTable.children.length - 2 && rightCell.value == "") {
                  cellCol++;
                  rightCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
              } else {
                while (cellCol < currentTable.children.length - 2 && rightCell.value != "") {
                  cellCol++;
                  rightCell = currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow];
                }
                if (cellCol != currentTable.children.length - 2) {
                  cellCol--;
                }
              }
            }

            //클릭된셀 색 제거
            document.querySelectorAll(".cellClicked").forEach(function (element) {
              element.classList.remove("cellClicked");
            });
            shadowRow = 0;
            shadowCol = 0;
          }
          currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].focus();

          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        } else if (event.shiftKey) {
          if (event.key == "ArrowUp") {
            if (shadowCol == 0) {
              if (shadowRow <= 0) {
                if (cellRow + shadowRow > 0) {
                  shadowRow--;
                  while (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide")) {
                    shadowRow--;
                  }
                  if (cellRow + shadowRow < 0) {
                    shadowRow++;
                  }
                  currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                }
              } else {
                shadowRow--;
                while (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow + 1].parentNode.classList.contains("hide")) {
                  shadowRow--;
                }
                currentRow.querySelectorAll(".textCell")[cellRow + shadowRow + 1].classList.remove("cellClicked");
              }
            } else {
              if (shadowRow <= 0) {
                if (cellRow + shadowRow > 0) {
                  shadowRow--;
                  if (shadowCol > 0) {
                    for (let i = 0; i <= shadowCol; i++) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    }
                  } else if (shadowCol < 0) {
                    for (let i = 0; i >= shadowCol; i--) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    }
                  }
                }
              } else {
                shadowRow--;
                if (shadowCol > 0) {
                  for (let i = 0; i <= shadowCol; i++) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow + 1].classList.remove("cellClicked");
                  }
                } else if (shadowCol < 0) {
                  for (let i = 0; i >= shadowCol; i--) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow + 1].classList.remove("cellClicked");
                  }
                }
              }
            }
          } else if (event.key == "ArrowDown") {
            if (shadowCol == 0) {
              if (shadowRow >= 0) {
                if (cellRow + shadowRow < 25) {
                  shadowRow++;
                  while (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].parentNode.classList.contains("hide")) {
                    shadowRow++;
                    if (cellRow + shadowRow > 25) {
                      shadowRow--;
                      break;
                    }
                  }
                  if (cellRow + shadowRow < 0) {
                    shadowRow--;
                  }
                  currentRow.querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                }
              } else {
                shadowRow++;
                while (currentRow.querySelectorAll(".textCell")[cellRow + shadowRow - 1].parentNode.classList.contains("hide")) {
                  shadowRow++;
                }
                currentRow.querySelectorAll(".textCell")[cellRow + shadowRow - 1].classList.remove("cellClicked");
              }
            } else {
              if (shadowRow >= 0) {
                if (cellRow + shadowRow < 25) {
                  shadowRow++;
                  if (shadowCol > 0) {
                    for (let i = 0; i <= shadowCol; i++) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    }
                  } else if (shadowCol < 0) {
                    for (let i = 0; i >= shadowCol; i--) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow].classList.add("cellClicked");
                    }
                  }
                }
              } else {
                shadowRow++;
                if (shadowCol > 0) {
                  for (let i = 0; i <= shadowCol; i++) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow - 1].classList.remove("cellClicked");
                  }
                } else if (shadowCol < 0) {
                  for (let i = 0; i >= shadowCol; i--) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + i].querySelectorAll(".textCell")[cellRow + shadowRow - 1].classList.remove("cellClicked");
                  }
                }
              }
            }
          } else if (event.key == "ArrowLeft") {
            if (shadowRow == 0) {
              if (shadowCol <= 0) {
                if (cellCol + shadowCol > -1) {
                  shadowCol--;
                  if (
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide") ||
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("merged")
                  ) {
                    shadowCol++;
                  }
                  if (cellCol + shadowCol < 0) {
                    shadowCol++;
                  }
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                }
              } else {
                shadowCol--;
                currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol + 1].querySelectorAll(".textCell")[cellRow].classList.remove("cellClicked");
              }
            } else {
              if (shadowCol <= 0) {
                if (cellCol + shadowCol > 0) {
                  shadowCol--;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                    }
                  } else if (shadowRow < 0) {
                    for (let i = 0; i >= shadowRow; i--) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                    }
                  }
                }
              } else {
                shadowCol--;
                if (shadowRow > 0) {
                  for (let i = 0; i <= shadowRow; i++) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                  }
                } else if (shadowRow < 0) {
                  for (let i = 0; i >= shadowRow; i--) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol + 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                  }
                }
              }
            }
          } else if (event.key == "ArrowRight") {
            if (shadowRow == 0) {
              if (shadowCol >= 0) {
                if (cellCol + shadowCol < currentTable.querySelectorAll(".teacherColumn").length - 1) {
                  shadowCol++;
                  if (
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide") ||
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("merged")
                  ) {
                    shadowCol--;
                  }
                  if (cellCol + shadowCol < 0) {
                    shadowCol--;
                  }
                  currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow].classList.add("cellClicked");
                  currentCell.classList.add("cellClicked");
                }
              } else {
                shadowCol++;
                currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol - 1].querySelectorAll(".textCell")[cellRow].classList.remove("cellClicked");
              }
            } else {
              if (shadowCol >= 0) {
                if (cellCol + shadowCol < currentTable.querySelectorAll(".teacherColumn").length - 1) {
                  shadowCol++;
                  if (shadowRow > 0) {
                    for (let i = 0; i <= shadowRow; i++) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                    }
                  } else if (shadowRow < 0) {
                    for (let i = 0; i >= shadowRow; i--) {
                      currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol].querySelectorAll(".textCell")[cellRow + i].classList.add("cellClicked");
                    }
                  }
                }
              } else {
                shadowCol++;
                if (shadowRow > 0) {
                  for (let i = 0; i <= shadowRow; i++) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                  }
                } else if (shadowRow < 0) {
                  for (let i = 0; i >= shadowRow; i--) {
                    currentTable.querySelectorAll(".teacherColumn")[cellCol + shadowCol - 1].querySelectorAll(".textCell")[cellRow + i].classList.remove("cellClicked");
                  }
                }
              }
            }
          }
          //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        } else if (event.altKey && event.key == "Enter") {
          event.preventDefault();
          currentCell.value += "\n";
          currentCell.classList.add("yesCursor");
        } else {
          if (event.key == "ArrowUp") {
            if (cellRow > 0) {
              cellRow--;
              while (currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                cellRow--;
              }
            }
          } else if (event.key == "ArrowDown" || event.key == "Enter") {
            event.preventDefault();
            if (cellRow < 25) {
              cellRow++;
              while (currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                cellRow++;
                if (cellRow > 25) {
                  cellRow--;
                  break;
                }
              }
            }
          } else if (event.key == "ArrowLeft") {
            if (cellCol > 0) {
              cellCol--;
              while (currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                cellRow--;
              }
            }
          } else if (event.key == "ArrowRight") {
            if (cellCol < currentTable.children.length - 2) {
              cellCol++;
              while (currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].parentNode.classList.contains("hide")) {
                cellRow--;
              }
            }
          } else if (event.key == "Delete") {
            deleteValue(currentCell);
          }
          currentTable.querySelectorAll(".teacherColumn")[cellCol].querySelectorAll(".textCell")[cellRow].focus();

          //클릭된셀 색 제거
          document.querySelectorAll(".cellClicked").forEach(function (element) {
            element.classList.remove("cellClicked");
          });
          shadowRow = 0;
          shadowCol = 0;

          currentCell = document.activeElement;
          currentRow = document.activeElement.parentNode.parentNode;
          currentTable = currentRow.parentNode;
          cellRow = Array.prototype.indexOf.call(div.children, currentCell.parentNode) - 1;
          cellCol = Array.prototype.indexOf.call(div.parentNode.children, div) - 1;

          if (thisPage.querySelector(".yesCursor")) {
            thisPage.querySelector(".yesCursor").classList.remove("yesCursor");
          }
        }
      }

      //선생님 이름셀에 이동함수 막는 함수
      function preventKeyDown(event) {
        event.stopPropagation();
      }

      //셀 내용 삭제 함수
      function deleteValue(textarea) {
        let allClickedCell = thisPage.querySelectorAll(".cellClicked");
        if (allClickedCell.length > 1) {
          for (let i = 0; i < allClickedCell.length; i++) {
            allClickedCell[i].value = "";
          }
        } else {
          textarea.value = "";
        }
      }

      //////////////////////텍스트 세로정렬///////////////////////////////////////
      /////////////여기에 \n 또는 글자수(가로) 계산해서 padding 조절하기
      function verticalText() {
        findThisPage();
        let allCells = thisPage.querySelectorAll(".textCell");
        for (let i = 0; i < allCells.length; i++) {
          if (allCells[i].value != "" && allCells[i].style.paddingTop == 0) {
            allCells[i].style.height = "auto";
            allCells[i].style.paddingTop = (allCells[i].parentNode.scrollHeight - allCells[i].scrollHeight) / 2 + "px";
            allCells[i].style.paddingBottom = allCells[i].parentNode.scrollHeight - allCells[i].scrollHeight + "px";
            console.log(allCells[i].style.paddingTop);
          }
        }
      }

      //마우스클릭시
      function mouseClick(div) {
        currentCell = document.activeElement;
        currentRow = document.activeElement.parentNode.parentNode;
        currentTable = currentRow.parentNode;
        cellRow = Array.prototype.indexOf.call(div.children, currentCell.parentNode) - 1;
        cellCol = Array.prototype.indexOf.call(div.parentNode.children, div) - 1;
        //클릭된셀 색 제거
        document.querySelectorAll(".cellClicked").forEach(function (element) {
          element.classList.remove("cellClicked");
        });
        shadowRow = 0;
        shadowCol = 0;
      }

      function ctrlC() {
        findThisPage();
        turnX = false;
        initCtrl();

        let allClickedCell = thisPage.querySelectorAll(".cellClicked");
        if (allClickedCell.length == 0 || allClickedCell.length == 1) {
          cellStorage.value = currentCell.value;
          cellStorage.merged = currentCell.parentNode.classList.contains("merged") ? "merged" : "";
          cellStorage.includingCell = currentCell.parentNode.getAttribute("includingCell") ? currentCell.parentNode.getAttribute("includingCell") : "";
          cellStorage.height = currentCell.parentNode.style.height ? currentCell.parentNode.style.height : "";
          currentCell.classList.add("ctrlBorder");
        } else {
          for (let i = 0; i < allClickedCell.length; i++) {
            let tempCellStorage = {
              value: allClickedCell[i].value,
              merged: allClickedCell[i].parentNode.classList.contains("merged") ? "merged" : "",
              includingCell: allClickedCell[i].parentNode.getAttribute("includingCell") ? allClickedCell[i].parentNode.getAttribute("includingCell") : "",
              height: allClickedCell[i].parentNode.style.height ? allClickedCell[i].parentNode.style.height : "",
            };
            ctrlStorage.push(tempCellStorage);
            allClickedCell[i].classList.add("ctrlBorder");
          }
        }
      }

      function ctrlX() {
        findThisPage();
        turnX = true;
        initCtrl();

        let allClickedCell = thisPage.querySelectorAll(".cellClicked");
        if (allClickedCell.length == 0) {
          cellStorage.value = currentCell.value;
          cellStorage.merged = currentCell.parentNode.classList.contains("merged") ? "merged" : "";
          cellStorage.includingCell = currentCell.parentNode.getAttribute("includingCell") ? currentCell.parentNode.getAttribute("includingCell") : "";
          cellStorage.height = currentCell.parentNode.style.height ? currentCell.parentNode.style.height : "";
          currentCell.classList.add("ctrlBorder");
        } else {
          for (let i = 0; i < allClickedCell.length; i++) {
            let tempCellStorage = {
              value: allClickedCell[i].value,
              merged: allClickedCell[i].parentNode.classList.contains("merged") ? "merged" : "",
              includingCell: allClickedCell[i].parentNode.getAttribute("includingCell") ? allClickedCell[i].parentNode.getAttribute("includingCell") : "",
              height: allClickedCell[i].parentNode.style.height ? allClickedCell[i].parentNode.style.height : "",
            };
            ctrlStorage.push(tempCellStorage);
            allClickedCell[i].classList.add("ctrlBorder");
          }
        }
      }

      function ctrlV() {
        findThisPage();
        let keepgoing = true;
        //잘라내기 셀 초기화
        if (turnX) {
          let allCtrlCell = thisPage.querySelectorAll(".ctrlBorder");
          for (let i = 0; i < allCtrlCell.length; i++) {
            allCtrlCell[i].classList.remove("ctrlBorder");
            allCtrlCell[i].value = "";
            if (parseInt(allCtrlCell[i].parentNode.getAttribute("includingCell")) > 1) {
              for (let j = 1; j < parseInt(allCtrlCell[i].parentNode.getAttribute("includingCell")); j++) {
                let cellIndex = Array.prototype.indexOf.call(allCtrlCell[i].parentNode.parentNode.children, allCtrlCell[i].parentNode) - 1;
                allCtrlCell[i].parentNode.parentNode.querySelectorAll(".textCell")[cellIndex + j].parentNode.classList.remove("hide");
              }
              allCtrlCell[i].parentNode.classList.remove("merged");
              allCtrlCell[i].parentNode.removeAttribute("includingCell");
              allCtrlCell[i].parentNode.style.height = "";
            }
          }
        }

        if (ctrlStorage.length > 0) {
          console.log(ctrlStorage);
          //여러 셀 복사면
          let cellHeight = 0;
          for (let i = 0; i < ctrlStorage.length; i++) {
            cellHeight += ctrlStorage[i].includingCell ? parseInt(ctrlStorage[i].includingCell) : 1;
          }
          for (let i = 0; i < cellHeight; i++) {
            if (currentRow.querySelectorAll(".textCell")[cellRow + i].parentNode.classList.contains("merged")) {
              keepgoing = false;
              alert("병합된 셀에서는 실행할 수 없습니다.");
              break;
            } else if (!currentRow.querySelectorAll(".textCell")[cellRow + cellHeight - 1]) {
              keepgoing = false;
              alert("범위를 초과하였습니다.");
              break;
            }
          }
          if (keepgoing) {
            let temp = 0;
            let plus = 0;
            for (let i = 0; i < ctrlStorage.length; i++) {
              currentRow.querySelectorAll(".textCell")[cellRow + i + plus].value = ctrlStorage[i].value;
              ctrlStorage[i].merged ? currentRow.querySelectorAll(".textCell")[cellRow + i + plus].parentNode.classList.add("merged") : "";
              ctrlStorage[i].includingCell
                ? currentRow.querySelectorAll(".textCell")[cellRow + i + plus].parentNode.setAttribute("includingCell", ctrlStorage[i].includingCell)
                : "";
              ctrlStorage[i].height ? (currentRow.querySelectorAll(".textCell")[cellRow + i + plus].parentNode.style.height = ctrlStorage[i].height) : "";

              for (let j = 1; j < ctrlStorage[i].includingCell; j++) {
                currentRow.querySelectorAll(".textCell")[cellRow + i + plus + j].parentNode.classList.add("hide");
                temp++;
              }
              plus = temp;
            }
          }
        } else {
          //한개 셀 복사면
          console.log(cellStorage);
          if (cellStorage.includingCell) {
            //한개 셀의 높이가 2이상이라면
            for (let i = 0; i < cellStorage.includingCell; i++) {
              if (currentRow.querySelectorAll(".textCell")[cellRow + i].parentNode.classList.contains("merged")) {
                keepgoing = false;
                alert("병합된 셀에서는 실행할 수 없습니다.");
                break;
              } else if (!currentRow.querySelectorAll(".textCell")[cellRow + parseInt(cellStorage.includingCell) - 1]) {
                keepgoing = false;
                alert("범위를 초과하였습니다.");
                break;
              }
            }
            if (keepgoing) {
              currentCell.value = cellStorage.value;
              cellStorage.merged ? currentCell.parentNode.classList.add(cellStorage.merged) : "";
              cellStorage.includingCell ? currentCell.parentNode.setAttribute("includingCell", cellStorage.includingCell) : "";
              cellStorage.height ? (currentCell.parentNode.style.height = cellStorage.height) : "";

              for (let i = 1; i < cellStorage.includingCell; i++) {
                currentRow.querySelectorAll(".textCell")[cellRow + i].parentNode.classList.add("hide");
              }
            }
          } else {
            //한개 셀의 높이가 1이라면
            currentCell.value = cellStorage.value;
            cellStorage.merged ? currentCell.parentNode.classList.add(cellStorage.merged) : "";
            cellStorage.includingCell ? currentCell.parentNode.getAttribute(cellStorage.includingCell) : "";
            cellStorage.height ? (currentCell.parentNode.style.height = cellStorage.height) : "";
          }
        }
      }

      function ctrlZ() {}

      //복사, 잘라내기 스토리지 비우기
      function initCtrl() {
        cellStorage = {};
        ctrlStorage = [];
        let allCtrlBorder = document.querySelectorAll(".ctrlBorder");
        for (let i = 0; i < allCtrlBorder.length; i++) {
          allCtrlBorder[i].classList.remove("ctrlBorder");
        }
      }

      //Top: 저장버튼 클릭 시 '요일별<->선생님별' 복사
      function saveData() {
        findThisPage();
        if (thisPage.querySelector(".middleDay").classList.contains("hide")) {
          //선생님별 -> 요일별

          //선생님 이름 복사
          for (let j = 0; j < numOfTeachers; j++) {
            for (let i = 0; i < 7; i++) {
              thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherName")[j].value = thisPage
                .querySelectorAll(".teacherTable")
                [j].querySelector(".teacherName").value;
            }
          }

          for (let i = 0; i < 7; i++) {
            for (let j = 0; j < numOfTeachers; j++) {
              for (let k = 0; k < 26; k++) {
                //셀 값 복사
                thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".textCell")[k].value = thisPage
                  .querySelectorAll(".teacherTable")
                  [j].querySelectorAll(".teacherColumn")
                  [i].querySelectorAll(".textCell")[k].value;
                //셀 merged/hide 클래스 복사
                if (thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.contains("merged")) {
                  thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.add("merged");
                } else if (thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.contains("hide")) {
                  thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.add("hide");
                } else if (!thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.contains("hide")) {
                  thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.remove("hide");
                }
                //includingcell 복사
                if (thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].getAttribute("includingCell")) {
                  thisPage
                    .querySelectorAll(".dayTable")
                    [i].querySelectorAll(".teacherColumn")
                    [j].querySelectorAll(".cell")
                    [k + 1].setAttribute(
                      "includingCell",
                      thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].getAttribute("includingCell")
                    );
                }
                //셀 높이 복사
                thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].style.height = thisPage
                  .querySelectorAll(".teacherTable")
                  [j].querySelectorAll(".teacherColumn")
                  [i].querySelectorAll(".cell")[k + 1].style.height;
              }
            }
          }
        } else {
          //요일별 -> 선생님별

          //선생님 이름 복사
          for (let i = 0; i < numOfTeachers; i++) {
            thisPage.querySelectorAll(".teacherTable")[i].querySelector(".teacherName").value = thisPage.querySelector(".dayTable").querySelectorAll(".teacherName")[i].value;
          }

          for (let i = 0; i < 7; i++) {
            for (let j = 0; j < numOfTeachers; j++) {
              for (let k = 0; k < 26; k++) {
                //셀 값 복사
                thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".textCell")[k].value = thisPage
                  .querySelectorAll(".dayTable")
                  [i].querySelectorAll(".teacherColumn")
                  [j].querySelectorAll(".textCell")[k].value;
                //셀 merged/hide 클래스 복사
                if (thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.contains("merged")) {
                  thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.add("merged");
                } else if (thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.contains("hide")) {
                  thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.add("hide");
                } else if (!thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].classList.contains("hide")) {
                  thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].classList.remove("hide");
                }
                //includingCell 복사
                if (thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].getAttribute("includingCell")) {
                  thisPage
                    .querySelectorAll(".teacherTable")
                    [j].querySelectorAll(".teacherColumn")
                    [i].querySelectorAll(".cell")
                    [k + 1].setAttribute(
                      "includingCell",
                      thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[j].querySelectorAll(".cell")[k + 1].getAttribute("includingCell")
                    );
                }
                //셀 높이 복사
                thisPage.querySelectorAll(".teacherTable")[j].querySelectorAll(".teacherColumn")[i].querySelectorAll(".cell")[k + 1].style.height = thisPage
                  .querySelectorAll(".dayTable")
                  [i].querySelectorAll(".teacherColumn")
                  [j].querySelectorAll(".cell")[k + 1].style.height;
              }
            }
          }
        }
      }

      //Top: 요일별버튼 클릭 시 '화면전환'
      function goToTeacherPage() {
        findThisPage();
        //클릭된셀 색 제거
        document.querySelectorAll(".cellClicked").forEach(function (element) {
          element.classList.remove("cellClicked");
        });
        shadowRow = 0;
        shadowCol = 0;

        //화면전환
        if (thisPage.querySelector(".middleTeacher").classList.contains("hide")) {
          document.querySelector(".btnDayandTeacher").innerHTML = "선생님별";
          thisPage.querySelector(".middleDay").classList.add("hide");
          thisPage.querySelector(".middleTeacher").classList.remove("hide");
        } else {
          document.querySelector(".btnDayandTeacher").innerHTML = "요일별";
          thisPage.querySelector(".middleDay").classList.remove("hide");
          thisPage.querySelector(".middleTeacher").classList.add("hide");
        }
      }

      //Top: 선생님 추가버튼 클릭 시
      function addTeacher() {
        findThisPage();
        //요일별: 1열을 복사하여 각 테이블에 붙이기
        for (let i = 0; i < 7; i++) {
          let cloneTeacherColumn = thisPage.querySelector(".teacherColumn").cloneNode(true);
          for (let j = 0; j < cloneTeacherColumn.querySelectorAll(".textCell").length; j++) {
            cloneTeacherColumn.querySelectorAll(".textCell")[j].value = "";
            cloneTeacherColumn.querySelector(".teacherName").value = "";
          }
          thisPage.querySelectorAll(".dayTable")[i].appendChild(cloneTeacherColumn);
        }

        //선생님별: 테이블 1개씩 추가하기
        let cloneTeacherTable = thisPage.querySelector(".teacherTable").cloneNode(true);
        for (let i = 0; i < cloneTeacherTable.querySelectorAll(".textCell").length; i++) {
          cloneTeacherTable.querySelectorAll(".textCell")[i].value = "";
          cloneTeacherTable.querySelector(".teacherName").value = "";
        }
        thisPage.querySelector(".middleTeacher").appendChild(cloneTeacherTable);

        findThisPage();
      }

      //Top: 선생님 삭제버튼 클릭 시
      function deleteTeacher() {
        findThisPage();
        //선생님 삭제버튼 클릭되어있을 때 클릭한 경우
        if (event.target.classList.contains("btnClicked")) {
          event.target.classList.remove("btnClicked");
          //화면이 middleDay
          if (thisPage.querySelector(".middleTeacher").classList.contains("hide")) {
            for (let i = 0; i < thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn").length; i++) {
              thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn")[i].classList.remove("redBorder");
            }
            //화면이 middleTeacher
          } else {
            for (let i = 0; i < thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn").length; i++) {
              thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn")[i].classList.remove("redBorder");
            }
          }
          //버튼 활성화
          for (let i = 0; i < thisPage.parentNode.querySelectorAll("button").length; i++) {
            if (thisPage.parentNode.querySelectorAll("button")[i].classList.contains("btnDeleteTeacher")) {
            } else {
              thisPage.parentNode.querySelectorAll("button")[i].disabled = false;
            }
          }
          //이벤트리스너 제거
          for (let i = 0; i < thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn").length; i++) {
            thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn")[i].removeEventListener("click", executeDelete);
          }
          for (let i = 0; i < thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn").length; i++) {
            thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn")[i].removeEventListener("click", executeDelete2);
          }
        } else {
          //선생님 삭제버튼 클릭안되어있을 때 클릭한 경우
          event.target.classList.add("btnClicked");

          //화면이 middleDay
          if (thisPage.querySelector(".middleTeacher").classList.contains("hide")) {
            for (let i = 0; i < thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn").length; i++) {
              thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn")[i].classList.add("redBorder");
            }
            //화면이 middleTeacher
          } else {
            for (let i = 0; i < thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn").length; i++) {
              thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn")[i].classList.add("redBorder");
            }
          }
          //버튼 비활성화
          for (let i = 0; i < thisPage.parentNode.querySelectorAll("button").length; i++) {
            if (thisPage.parentNode.querySelectorAll("button")[i].classList.contains("btnDeleteTeacher")) {
            } else {
              thisPage.parentNode.querySelectorAll("button")[i].disabled = true;
            }
          }
          //이벤트리스너 추가
          for (let i = 0; i < thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn").length; i++) {
            thisPage.querySelector(".middleDay").querySelectorAll(".teacherColumn")[i].addEventListener("click", executeDelete);
          }
          for (let i = 0; i < thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn").length; i++) {
            thisPage.querySelector(".middleTeacher").querySelectorAll(".timeColumn")[i].addEventListener("click", executeDelete2);
          }
        }
      }

      //Top: 병합버튼 클릭 시
      function mergeCell() {
        findThisPage();
        let allClickedCell = thisPage.querySelectorAll(".cellClicked");
        let doSeparate = false;

        //해제
        if (allClickedCell.length == 0) {
          if (currentCell.parentNode.getAttribute("includingCell")) {
            let cellIndex = Array.prototype.indexOf.call(currentCell.parentNode.parentNode.children, currentCell.parentNode) - 1;
            for (let k = cellIndex + 1; k <= cellIndex + parseInt(currentCell.parentNode.getAttribute("includingCell")); k++) {
              if (k > 25) {
                break;
              }
              currentRow.querySelectorAll(".textCell")[k].parentNode.classList.remove("hide");
            }
            currentCell.parentNode.classList.remove("merged");
            currentCell.parentNode.removeAttribute("style");
            currentCell.parentNode.removeAttribute("includingCell");
            currentCell.focus();
          } else {
            return;
          }
        } else if (allClickedCell[0].parentNode.parentNode === allClickedCell[allClickedCell.length - 1].parentNode.parentNode) {
          for (let j = 0; j < allClickedCell.length; j++) {
            if (allClickedCell[j].parentNode.classList.contains("merged")) {
              doSeparate = true;
              let cellIndex = Array.prototype.indexOf.call(allClickedCell[j].parentNode.parentNode.children, allClickedCell[j].parentNode) - 1;
              for (let k = cellIndex + 1; k <= cellIndex + parseInt(allClickedCell[j].parentNode.getAttribute("includingCell")); k++) {
                if (k > 25) {
                  break;
                }
                currentRow.querySelectorAll(".textCell")[k].parentNode.classList.remove("hide");
                currentRow.querySelectorAll(".textCell")[k - 1].classList.add("cellClicked");
              }

              allClickedCell[j].parentNode.classList.remove("merged");
              allClickedCell[j].parentNode.removeAttribute("style");
              allClickedCell[j].parentNode.removeAttribute("includingCell");
              allClickedCell[0].focus();
            }
          }

          //병합
          if (doSeparate == false) {
            for (let i = 1; i < allClickedCell.length; i++) {
              allClickedCell[i].parentNode.classList.add("hide");
              allClickedCell[i].classList.remove("cellClicked");
              allClickedCell[i].value = "";
            }
            allClickedCell[0].parentNode.classList.add("merged");
            allClickedCell[0].parentNode.style.height = 3.7 * allClickedCell.length + "%";
            allClickedCell[0].parentNode.setAttribute("includingCell", allClickedCell.length);
            allClickedCell[0].focus();
          }
        } else {
          for (let i = 0; i < allClickedCell.length; i++) {
            allClickedCell[i].classList.remove("cellClicked");
          }
          currentCell.focus();
        }
      }

      //deleteTeacher의 하위함수: middleDay에서 선생님 삭제
      function executeDelete(event) {
        let index = Array.prototype.indexOf.call(event.target.parentNode.parentNode.parentNode.children, event.target.parentNode.parentNode) - 1;
        if (numOfTeachers > 1) {
          for (let i = 0; i < 7; i++) {
            thisPage.querySelector(".middleDay").querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[index].remove();
          }
          thisPage.querySelector(".middleTeacher").querySelectorAll(".teacherTable")[index].remove();
        }
        numOfTeachers = thisPage.querySelector(".dayTable").querySelectorAll(".teacherColumn").length;
      }

      //deleteTeacher의 하위함수: middleTeacher에서 선생님 삭제
      function executeDelete2(event) {
        let index = Array.prototype.indexOf.call(event.target.parentNode.parentNode.parentNode.children, event.target.parentNode.parentNode);
        if (numOfTeachers > 1) {
          thisPage.querySelector(".middleTeacher").querySelectorAll(".teacherTable")[index].remove();
          for (let i = 0; i < 7; i++) {
            thisPage.querySelector(".middleDay").querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[index].remove();
          }
          numOfTeachers = thisPage.querySelector(".dayTable").querySelectorAll(".teacherColumn").length;
        }
      }

      //middle: 선생님 이름칸 클릭 시 이름 변경
      function nameTeacher(input) {
        findThisPage();
        //선생님 이름 모든 열에 복사
        let thisTeacherName = input;
        thisTeacherName.addEventListener("keydown", function (event) {
          if (event.key == "Enter" || event.key == "Tab") {
            event.preventDefault();
            if (thisPage.querySelector(".middleTeacher").classList.contains("hide")) {
              let index = Array.prototype.indexOf.call(input.parentNode.parentNode.parentNode.children, input.parentNode.parentNode) - 1;
              for (let i = 0; i < 7; i++) {
                thisPage.querySelectorAll(".dayTable")[i].querySelectorAll(".teacherColumn")[index].querySelector("input").value = input.value;
              }
              if (currentTable.querySelectorAll(".teacherColumn")[index + 1]) {
                currentTable.querySelectorAll(".teacherColumn")[index + 1].querySelector(".teacherName").focus();
              } else {
                this.blur();
              }
            }
            this.blur();
          }
        });
      }

      //Bottom: 페이지 추가버튼 클릭 시 '버튼 생성 및 페이지 생성'
      function addPageBtn() {
        findThisPage();
        //새 버튼 추가
        let newPageBtn = document.createElement("button");
        newPageBtn.classList.add("btnAddedPage");
        newPageBtn.addEventListener("dblclick", pageBtnNaming);

        newPageBtn.addEventListener("click", shiftPage);
        document.querySelector(".bottom").insertBefore(newPageBtn, document.querySelector(".btnDeletePage"));

        //새 페이지 추가
        let result = confirm("새로운 페이지 생성: OK\n기존 페이지 복사: Cancel");
        let clonePage;
        clonePage = document.querySelectorAll(".middle")[pageIndex].cloneNode(true);
        if (result) {
          for (let i = 0; i < clonePage.querySelectorAll(".textCell").length; i++) {
            clonePage.querySelectorAll(".textCell")[i].value = "";
          }
        }
        clonePage.classList.add("hide");
        document.querySelector(".container").insertBefore(clonePage, document.querySelector(".container").children[2]);

        //페이지 수 기억
        numOfPages = document.querySelectorAll(".middle").length;
      }

      //Bottom: 페이지버튼 클릭 시 '페이지 전환'
      function shiftPage() {
        findThisPage();
        //클릭된셀 색 제거
        document.querySelectorAll(".cellClicked").forEach(function (element) {
          element.classList.remove("cellClicked");
        });
        shadowRow = 0;
        shadowCol = 0;

        thisPage.classList.add("hide");
        thisPageBtn.classList.remove("btnClicked");
        event.target.classList.add("btnClicked");
        findThisPage();

        thisPage.classList.remove("hide");

        //페이지 전환 후, 요일별vs선생님별 설정
        if (thisPage.querySelector(".middleTeacher").classList.contains("hide")) {
          document.querySelector(".btnDayandTeacher").innerHTML = "요일별";
        } else {
          document.querySelector(".btnDayandTeacher").innerHTML = "선생님별";
        }
      }

      //Bottom: 페이지 삭제 함수
      function deletePage() {
        findThisPage();

        if (numOfPages > 1) {
          //삭제여부 확인
          let result = confirm("정말로 페이지를 삭제하시겠습니까?");
          if (result) {
            thisPage.remove();
            document.querySelectorAll(".middle")[0].classList.remove("hide");

            thisPageBtn.remove();
            document.querySelectorAll(".btnAddedPage")[0].classList.add("btnClicked");
          }
        }
        findThisPage();
      }

      //Bottom: 페이지 이름 변경 함수
      function pageBtnNaming() {
        findThisPage();
        let button = thisPageBtn;
        if (button.innerHTML != "") {
          button.innerHTML = "";
        }
        let tempInput = document.createElement("input");
        tempInput.classList.add("namingInput");
        button.appendChild(tempInput);
        tempInput.focus();

        tempInput.addEventListener("keydown", function (event) {
          if (event.key == "Enter" || event.key == "Tab") {
            button.innerHTML = tempInput.value;
            tempInput.remove();
          }
        });
      }
    </script>
  </body>
</html>
